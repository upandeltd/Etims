{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2024-04-11 15:20:29.668752",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Sales Invoice",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "<link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n\n{% if doc.is_return and  doc.custom_original_invoice_number != 0 %}\n    <h3>CREDIT NOTE</h3>\n    <p>Original Invoice No: {{ doc.custom_sales_control_unit }}/{{ doc.custom_original_invoice_number }}</p>\n    <p>THE CREDIT NOTE IS ONLY APPROVED FOR ORIGINAL SALES RECEIPT</p>\n    \n{% else %}\n    <h3>SALES INVOICE</h3>\n{% endif %}\n{%- macro add_header(page_num, max_pages, doc, letter_head, no_letterhead) -%}\n    {% if letter_head and not no_letterhead %}\n    <div class=\"letter-head\">{{ letter_head }}</div>\n    {% endif %}\n    {%- if doc.meta.is_submittable and doc.docstatus==0-%}\n    <div class=\"alert alert-info text-center\">\n        <h4 style=\"margin: 0px;\">{{ _(\"PROFORMA\") }}</h4></div>\n    {%- endif -%}\n    {%- if doc.meta.is_submittable and doc.docstatus==2-%}\n    <div class=\"alert alert-danger text-center\">\n        <h4 style=\"margin: 0px;\">{{ _(\"CANCELLED\") }}</h4></div>\n    {%- endif -%}\n    {% if max_pages > 1 %}\n    <p class=\"text-right\">{{ _(\"Page #{0} of {1}\").format(page_num, max_pages) }}</p>\n    {% endif %}\n{%- endmacro -%}\n\n{{ add_header(0,1,doc,letter_head, no_letterhead) }}\n<table class=\"table table-bordered\">\n<tbody>\n  <tr>\n    <th width=\"50%\"><strong>Customer Details</strong></th>\n    <th colspan=\"2\"><strong><b>TRADER INVOICE NUMBER&nbsp;: {{doc.name}}</b></strong></th>\n  </tr>\n  <tr>\n    <td rowspan=\"6\">{{ doc.customer_name }}<br>\n    {{ doc.address_display or '' }}</td>\n  </tr>\n  <tr>\n    <th width=\"20%\">Invoice Date</th>\n    <td width=\"30%\">{{ doc.get_formatted(\"posting_date\") or '' }}</td>\n  </tr>\n  <tr>\n    <th>Customer PIN</th>\n    <td>{{ doc.tax_id }}</td>\n  </tr>\n  </tbody>\n</table>\n\n\n<table class=\"table table-bordered\">\n\t<tbody>\n{% set this_docs_vat_rate = frappe.db.get_value(\"Sales Taxes and Charges\", {\"parent\": doc.name}, \"rate\") %}\n{% set taxable = {'amount_origin': 0, 'tax':0} %}\n{% set non_taxable = {'amount_origin': 0, 'tax':0} %}\n{% set discount = {'total': 0} %}\n\t\t<tr>\n\t\t\t<th>No</th>\n\t\t\t<th>Description</th>\n\t\t\t<th class=\"text-right\">Qty</th>\n\t\t\t<th>Rate</th>\n\t\t\t<th class=\"text-right\">Disc.</th>\n\t\t\t<th class=\"text-right\">Amount</th>\n\t\t\t<th class=\"text-right\">VAT Rate</th>\n\t\t</tr>\n\t\t{%- for row in doc.items -%}\n\t\t<tr>\n\t\t\t<td style=\"width: 3%;\">{{ row.idx }}</td>\n\t\t\t<td style=\"width: 30%;\">{{ row.description }}</td>\n\t\t\t<td style=\"width: 5%; text-align: right;\">{{ row.qty }}</td>\n\t\t\t<td style=\"width: 10%;\">{{ \"%.2f\"|format(row.rate +(row.discount_amount) ) }}<div style=\"border: 0px;\"></div></td>\n\t\t\t<td style=\"width: 15%; text-align: right;\">{{ \"%.2f\"|format(row.discount_amount * row.qty)}}<br> {% if row.custom_discount_name %} {{ row.custom_discount_name }} {% endif %}</td>\n\t\t\t<td style=\"width: 20%; text-align: right;\">{{ row.get_formatted(\"amount\", doc) }}</td>\n\t\t\t<td style=\"width: 15%; text-align: right;\">{{ row.custom_tax_code_name }}</td>\n\n\t\t</tr>\n\t\t{%- endfor -%}\n\t</tbody>\n</table>\n\n<div>\n    <p>Items Number: <span>{{ doc.custom_item_count }}</span></p>\n</div>\n\n<table class=\"table table-bordered\">\n\t<tbody>\n\n{% if doc.custom_total_discount_amount%}\n\n<TR>\n\t<Th colspan=3 align=right><B>Total Before Discount</B></Th>\n\t<TD colspan=5 align=right><B>{{ doc.get_formatted(\"custom_total_before_discount\", doc) }}</B></TD>\n\t\n</TR>\n\n<TR>\n\t<Th colspan=3 align=right><B>Total Discount</B></Th>\n\t<TD colspan=5 align=right><B>{{ doc.get_formatted(\"custom_total_discount_amount\", doc) }}</B></TD>\n\t\n</TR>\n{% endif %}\n\n<TR>\n\t<Th colspan=3 align=right><B>Net Amount (excluding VAT)</B></Th>\n\t<TD colspan=5 align=right><B>{{ doc.get_formatted(\"net_total\", doc) }}</B></TD>\n\t\n</TR>\n\n{% if doc.custom_total_taxable_amount > 0 %}\n\n<TR>\n\t<Th colspan=3 align=right><B>Taxable Amount</B></Th>\n\t<TD colspan=5 align=right><B>{{ doc.get_formatted(\"custom_total_taxable_amount\", doc) }}</B></TD>\n\t\n</TR>\n\n{% endif %}\n\n{% if doc.custom_total_nontaxable_amount > 0 %}\n\n<TR>\n\t<Th colspan=3 align=right><B>Non-Taxable Amount</B></Th>\n\t<TD colspan=5 align=right><B>{{ doc.get_formatted(\"custom_total_nontaxable_amount\", doc) }}</B></TD>\n\t\n</TR>\n\n{% endif %}\n\n\n<TR>\n\t<Th colspan=3 align=right><B>VAT</B></Th>\n\t<TD colspan=5 align=right><B>{{ doc.get_formatted(\"base_total_taxes_and_charges\", doc) }}</B></TD>\n\t\n</TR>\n\n<TR>\n\t<Th colspan=3 align=right><B>Gross Amount (including VAT)</B></Th>\n\t<TD colspan=5 align=right><B>{{ doc.get_formatted(\"rounded_total\", doc) }}</B></TD>\n</TR>\n\n\t</tbody>\n</table>\n\n{% set item_taxA =  {'totTaxAmt': 0, 'taxAmt': 0} %}\n{% set item_taxB =  {'totTaxAmt': 0, 'taxAmt': 0} %}\n{% set item_taxC =  {'totTaxAmt': 0, 'taxAmt': 0} %}\n{% set item_taxD =  {'totTaxAmt': 0, 'taxAmt': 0} %}\n{% set item_taxE =  {'totTaxAmt': 0, 'taxAmt': 0} %}\n\t\n{% if doc.taxes %}\n\t{% for row in doc.taxes %}\n\t\t{% if row.custom_code == 'A' %}\n\t\t\t{% if item_taxA.update({'totTaxAmt': row.custom_total_taxable_amount }) %}{% endif %}\n\t\t\t{% if item_taxA.update({'taxAmt': row.base_tax_amount_after_discount_amount }) %}{% endif %}\n\t\t\t\n\t\t{% endif %}\n\t\t{% if row.custom_code == 'B' %}\n\t\t\t{% if item_taxB.update({'totTaxAmt': row.custom_total_taxable_amount }) %}{% endif %}\n\t\t\t{% if item_taxB.update({'taxAmt': row.base_tax_amount_after_discount_amount }) %}{% endif %}\n\t\t\t\n\t\t{% endif %}\n\t\t{% if row.custom_code == 'C' %}\n\t\t\t{% if item_taxC.update({'totTaxAmt': row.custom_total_taxable_amount }) %}{% endif %}\n\t\t\t{% if item_taxC.update({'taxAmt': row.base_tax_amount_after_discount_amount }) %}{% endif %}\n\t\t\t\n\t\t{% endif %}\n\t\t{% if row.custom_code == 'D' %}\n\t\t\t{% if item_taxD.update({'totTaxAmt': row.custom_total_taxable_amount }) %}{% endif %}\n\t\t\t{% if item_taxD.update({'taxAmt': row.base_tax_amount_after_discount_amount }) %}{% endif %}\n\t\t\t\n\t\t{% endif %}\n\t\t{% if row.custom_code == 'E' %}\n\t\t\t{% if item_taxE.update({'totTaxAmt': row.custom_total_taxable_amount }) %}{% endif %}\n\t\t\t{% if item_taxE.update({'taxAmt': row.base_tax_amount_after_discount_amount }) %}{% endif %}\n\t\t\t\n\t\t{% endif %}\n\t{% endfor %}\n\t\n{% endif %}\n\n<table class=\"table table-bordered\">\n    <tbody>\n        <tr>\n\t\t\t<th>Rate</th>\n\t\t\t<th>Taxable Amount</th>\n\t\t\t<th>VAT</th>\n\t\t</tr>\n\t\t\n\t\t<tr>\n\t<td style=\"width: 30%;\">A</td>\n\t<td style=\"width: 40%;\">{{ frappe.format_value(item_taxA['totTaxAmt'], {'fieldtype': 'Currency', 'options': 'KSH'}) or 0 }}</td>\n\t<td style=\"width: 30%;\">{{frappe.format_value(item_taxA['taxAmt'], {'fieldtype': 'Currency', 'options': 'KSH'}) or 0 }}</td>\n</tr>\n<tr>\n\t<td style=\"width: 30%;\">B</td>\n\t<td style=\"width: 40%;\">{{ frappe.format_value(item_taxB['totTaxAmt'], {'fieldtype': 'Currency', 'options': 'KSH'}) or 0 }}</td>\n\t<td style=\"width: 30%;\">{{frappe.format_value(item_taxB['taxAmt'], {'fieldtype': 'Currency', 'options': 'KSH'}) or 0 }}</td>\n</tr>\n<tr>\n\t<td style=\"width: 30%;\">C</td>\n\t<td style=\"width: 40%;\">{{ frappe.format_value(item_taxC['totTaxAmt'], {'fieldtype': 'Currency', 'options': 'KSH'}) or 0 }}</td>\n\t<td style=\"width: 30%;\">{{frappe.format_value(item_taxC['taxAmt'], {'fieldtype': 'Currency', 'options': 'KSH'}) or 0 }}</td>\n</tr>\n<tr>\n\t<td style=\"width: 30%;\">D</td>\n\t<td style=\"width: 40%;\">{{ frappe.format_value(item_taxD['totTaxAmt'], {'fieldtype': 'Currency', 'options': 'KSH'}) or 0 }}</td>\n\t<td style=\"width: 30%;\">{{frappe.format_value(item_taxD['taxAmt'], {'fieldtype': 'Currency', 'options': 'KSH'}) or 0 }}</td>\n</tr>\n\n    </tbody>\n</table>\n\n<div>\n    <div class=\"row\">\n        <div class=\"col\">\n            <h3>Control Unit Information</h3>\n            <div class=\"row\">\n                <p class=\"col\">Date: {{ doc.custom_control_unit_date }}</p>\n                <p class=\"col\">Time: {{ doc.custom_control_unit_time }}</p>\n            </div>\n            \n            <p>Control Unit ID: {{ doc.custom_sales_control_unit }}</p>\n            <p>Control Unit Invoice No: {{ doc.custom_sales_control_unit }}/{{ doc.custom_invoice_number }}</p>\n            \n            {% if doc.is_return and  doc.custom_original_invoice_number != 0 %}\n                <p>Original Invoice No: {{ doc.custom_sales_control_unit }}/{{ doc.custom_original_invoice_number }}</p>\n\n            {% endif %}\n            \n            <p>Internal Data: {{ doc.custom_internal_data[:4] + \"-\" + doc.custom_internal_data[4:8] + \"-\" + doc.custom_internal_data[8:12] + \"-\" + doc.custom_internal_data[12:16] + \"-\" + doc.custom_internal_data[16:20] + \"-\" + doc.custom_internal_data[20:24]  + \"-\" + doc.custom_internal_data[24:26] }}</p>\n            <p>Receipt Signature: {{ doc.custom_receipt_signature[:4] + \"-\" + doc.custom_receipt_signature[4:8] + \"-\" + doc.custom_receipt_signature[8:12] + \"-\" + doc.custom_receipt_signature[12:16] }}</p>\n        </div>\n        <div class=\"col\">\n            <img src={{doc.custom_receipt_qr_code}} width=\"300\">\n        </div>\n    </div>\n</div>",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2024-11-20 20:51:56.409724",
 "modified_by": "Administrator",
 "module": "Kenya Etims Compliance",
 "name": "Kenya Detailed Tax Invoice",
 "owner": "Administrator",
 "page_number": "Hide",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}