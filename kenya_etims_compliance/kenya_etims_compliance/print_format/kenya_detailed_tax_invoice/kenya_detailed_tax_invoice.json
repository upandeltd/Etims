{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2024-04-11 15:20:29.668752",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Sales Invoice",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "<link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\r\n<h3>SALES INVOICE</h3>\r\n{%- macro add_header(page_num, max_pages, doc, letter_head, no_letterhead) -%}\r\n    {% if letter_head and not no_letterhead %}\r\n    <div class=\"letter-head\">{{ letter_head }}</div>\r\n    {% endif %}\r\n    {%- if doc.meta.is_submittable and doc.docstatus==0-%}\r\n    <div class=\"alert alert-info text-center\">\r\n        <h4 style=\"margin: 0px;\">{{ _(\"PROFORMA\") }}</h4></div>\r\n    {%- endif -%}\r\n    {%- if doc.meta.is_submittable and doc.docstatus==2-%}\r\n    <div class=\"alert alert-danger text-center\">\r\n        <h4 style=\"margin: 0px;\">{{ _(\"CANCELLED\") }}</h4></div>\r\n    {%- endif -%}\r\n    {% if max_pages > 1 %}\r\n    <p class=\"text-right\">{{ _(\"Page #{0} of {1}\").format(page_num, max_pages) }}</p>\r\n    {% endif %}\r\n{%- endmacro -%}\r\n\r\n{{ add_header(0,1,doc,letter_head, no_letterhead) }}\r\n<table class=\"table table-bordered\">\r\n<tbody>\r\n  <tr>\r\n    <th width=\"50%\"><strong>Customer Details</strong></th>\r\n    <th colspan=\"2\"><strong><b>INVOICE NUMBER&nbsp;: {{doc.name}}</b></strong></th>\r\n  </tr>\r\n  <tr>\r\n    <td rowspan=\"6\">{{ doc.customer_name }}<br>\r\n    {{ doc.address_display or '' }}</td>\r\n  </tr>\r\n  <tr>\r\n    <th width=\"20%\">Invoice Date</th>\r\n    <td width=\"30%\">{{ doc.get_formatted(\"posting_date\") or '' }}</td>\r\n  </tr>\r\n  <tr>\r\n    <th>Customer PIN</th>\r\n    <td>{{ doc.custom_pin }}</td>\r\n  </tr>\r\n  </tbody>\r\n</table>\r\n\r\n\r\n<table class=\"table table-bordered\">\r\n\t<tbody>\r\n{% set this_docs_vat_rate = frappe.db.get_value(\"Sales Taxes and Charges\", {\"parent\": doc.name}, \"rate\") %}\r\n{% set taxable = {'amount_origin': 0, 'tax':0} %}\r\n{% set non_taxable = {'amount_origin': 0, 'tax':0} %}\r\n{% set discount = {'total': 0} %}\r\n\t\t<tr>\r\n\t\t\t<th>No</th>\r\n\t\t\t<th>Description</th>\r\n\t\t\t<th class=\"text-right\">Qty</th>\r\n\t\t\t<th>Rate</th>\r\n\t\t\t<th class=\"text-right\">Disc.</th>\r\n\t\t\t<th class=\"text-right\">Amount</th>\r\n\t\t\t<th class=\"text-right\">VAT Rate</th>\r\n\t\t</tr>\r\n\t\t{%- for row in doc.items -%}\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 3%;\">{{ row.idx }}</td>\r\n\t\t\t<td style=\"width: 40%;\">{{ row.description }}</td>\r\n\t\t\t<td style=\"width: 5%; text-align: right;\">{{ row.qty }}</td>\r\n\t\t\t<td style=\"width: 15%;\">{{ \"%.2f\"|format(row.rate +(row.discount_amount) ) }}\r\n\t\t\t\t<div style=\"border: 0px;\"></div></td>\r\n\t\t\t<td style=\"width: 8%; text-align: right;\">{{ \"%.2f\"|format(row.discount_amount * row.qty)}}</td>\r\n\t\t\r\n\t\t\t<td style=\"width: 24%; text-align: right;\">{{\r\n\t\t\t\trow.get_formatted(\"amount\", doc) }}</td>\r\n\t\t\t\t{% if discount.update({'total': discount['total']+row.discount_amount}) %} {% endif %}\r\n\t\t\t<td style=\"width: 15%; text-align: right;\">\r\n\t\t\t    {% if row.item_tax_template %}\r\n        \t        {% set item_tax = frappe.get_doc('Item Tax Template', row.item_tax_template) %}\r\n        \t        \r\n        \t        {% set ttotal = {'val': 0} %}\r\n        \t        {% for i in item_tax.taxes %}\r\n        \t            {% if ttotal.update({'val': ttotal['val']+i.tax_rate}) %} {% endif %}\r\n        \t        {% endfor %}\r\n        \t        {% if ttotal['val']>0 %}\r\n        \t            {% if taxable.update({'amount_origin': taxable['amount_origin']+row.amount}) %} {% endif %}\r\n        \t            {% for i in item_tax.taxes %}\r\n            \t            {% if taxable.update({'tax': taxable['tax']+row.amount*(i.tax_rate)}) %} {% endif %}\r\n        \t            {% endfor %}\r\n        \t        {% else %}\r\n            \t             {% if non_taxable.update({'amount_origin': non_taxable['amount_origin']+row.amount}) %} {% endif %}\r\n            \t    {% endif %}\r\n            \t    \r\n        \t        {% for i in item_tax.taxes %}\r\n        \t                \r\n            \t            {{i.tax_rate}}%\r\n            \t            \r\n        \t        {% endfor %}\r\n            \t {% else %}\r\n            \t        0.0%\r\n            \t        {% if non_taxable.update({'amount_origin': non_taxable['amount_origin']+row.amount}) %} {% endif %}\r\n            \t {% endif %}\r\n            \t    \r\n\t\t\t    </td>\r\n\t\t</tr>\r\n\t\t{%- endfor -%}\r\n\t<TR>\r\n        <TD colspan=5 rowspan=5>\r\n            Amount in Words<br>\r\n            <B>{{ doc.base_in_words }}</B>\r\n        </TD>\r\n\t<Th WIDTH=15% align=right><B>Taxable Amount</B></Th>\r\n\t<Td WIDTH=15% align=right><B>{{frappe.format_value(taxable['amount_origin'], {'fieldtype': 'Currency', 'options': 'KSH'})}}</B></Td>\r\n</TR>\r\n\r\n<!--<TR>-->\r\n<!--\t<Th align=right><B>VAT (Item)</B></Th>-->\r\n<!--\t<TD WIDTH=20% align=right><B>{{frappe.format_value(taxable['tax'], {'fieldtype': 'Currency', 'options': 'KSH'})}}</B></TD>-->\r\n\t\r\n<!--</TR>-->\r\n<TR>\r\n\t<Th align=right><B>VAT</B></Th>\r\n\t<TD WIDTH=20% align=right><B>{{ doc.get_formatted(\"base_total_taxes_and_charges\", doc) }}</B></TD>\r\n\t\r\n</TR>\r\n<TR>\r\n\t<Th align=right><B>Exempted Amount</B></Th>\r\n\t<TD WIDTH=20% align=right><B>{{frappe.format_value(non_taxable['amount_origin'], {'fieldtype': 'Currency', 'options': 'KSH'})}}</B></TD>\r\n\t\r\n</TR>\r\n\r\n<TR>\r\n\t<Th align=right><B>Discount</B></Th>\r\n\t<TD WIDTH=20% align=right><B>\r\n\t    {% set disc = doc.grand_total - ((doc.additional_discount_percentage) * doc.grand_total) %}\r\n\t     {{frappe.format_value(doc.discount_amount, {'fieldtype': 'Currency', 'options': 'KSH'})}}\r\n\t    <!--{{frappe.format_value(discount['total'], {'fieldtype': 'Currency', 'options': 'KSH'})}}-->\r\n\t    </B></TD>\r\n\t\r\n</TR>\r\n<!--<TR>-->\r\n<!--\t<Th align=right><B>Total Taxes and Charges</B></Th>-->\r\n<!--\t<TD WIDTH=20% align=right><B>{{frappe.format_value(doc.total_taxes_and_charges, {'fieldtype': 'Currency', 'options': 'KSH'})}}</B></TD>-->\r\n\t\r\n<!--</TR>-->\r\n<TR>\r\n\t<Th align=right><B>Amount Payable</B></Th>\r\n\t<TD WIDTH=15% align=right><B>{{ doc.get_formatted(\"rounded_total\", doc) }}</B></TD>\r\n</TR>\r\n\r\n\t</tbody>\r\n</table>\r\n\r\n\r\n<table class=\"table table-bordered\">\r\n    <tbody>\r\n        <tr>\r\n\t\t\t<th>Rate</th>\r\n\t\t\t<th>Taxable Amount</th>\r\n\t\t\t<th>VAT</th>\r\n\t\t</tr>\r\n        {%- for row in doc.taxes -%}\r\n\t\t<tr>\r\n\t\t\t<td style=\"width: 30%;\">{{ row.custom_code_name }}</td>\r\n\t\t\t<td style=\"width: 40%;\">{{ row.custom_total_taxable_amount }}</td>\r\n\t\t\t<td style=\"width: 30%;\">{{ row.base_tax_amount_after_discount_amount }}</td>\r\n\t\t\t\r\n\t\t\t\r\n\t\t</tr>\r\n\t\t{%- endfor -%} \t\r\n        \r\n    </tbody>\r\n</table>\r\n\r\n<div>\r\n    <div class=\"row d-flex flex-row\">\r\n        <div class=\"col\">\r\n            <h3>Control Unit Information</h3>\r\n            <p>Date: </p>\r\n            <p>Time: </p>\r\n            <p>Control Unit ID: {{ doc.custom_sales_control_unit }}</p>\r\n            <p>Control Unit Invoice No: {{ doc.custom_sales_control_unit }}/{{ doc.custom_invoice_number }}</p>\r\n            <p>Internal Data: {{ doc.custom_internal_data }}</p>\r\n            <p>Receipt Signature: {{ doc.custom_receipt_signature }}</p>\r\n        </div>\r\n        <div class=\"col\">\r\n            <img src={{doc.custom_receipt_qr_code}} width=\"300\">\r\n        </div>\r\n    </div>\r\n</div>\r\n",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2024-04-12 01:50:50.766845",
 "modified_by": "Administrator",
 "module": "Kenya Etims Compliance",
 "name": "Kenya Detailed Tax Invoice",
 "owner": "Administrator",
 "page_number": "Hide",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}